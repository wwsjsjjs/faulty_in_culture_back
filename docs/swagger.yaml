basePath: /
definitions:
  dto.ChatMessageRequest:
    properties:
      content:
        type: string
      session_id:
        type: integer
    required:
    - content
    - session_id
    type: object
  dto.ChatStartRequest:
    properties:
      title:
        type: string
    type: object
  dto.SaveGameRequest:
    properties:
      game_data:
        type: string
    required:
    - game_data
    type: object
  dto.SendMessageRequest:
    properties:
      message:
        type: string
      user_id:
        type: integer
    required:
    - message
    - user_id
    type: object
  dto.UpdateScoreRequest:
    properties:
      score:
        minimum: 0
        type: integer
    required:
    - score
    type: object
  dto.UserLoginRequest:
    properties:
      password:
        type: string
      username:
        type: string
    required:
    - password
    - username
    type: object
  dto.UserRegisterRequest:
    properties:
      password:
        type: string
      username:
        type: string
    required:
    - password
    - username
    type: object
  vo.ChatHistoryResponse:
    properties:
      messages:
        items:
          $ref: '#/definitions/vo.ChatMessageResponse'
        type: array
      session:
        $ref: '#/definitions/vo.ChatSessionResponse'
    type: object
  vo.ChatMessageResponse:
    properties:
      content:
        type: string
      created_at:
        type: string
      id:
        type: integer
      role:
        type: integer
      session_id:
        type: integer
    type: object
  vo.ChatSessionResponse:
    properties:
      created_at:
        type: string
      id:
        type: integer
      title:
        type: string
      type:
        type: integer
      user_id:
        type: integer
    type: object
  vo.ErrorResponse:
    properties:
      error:
        description: Error 错误信息
        example: invalid request
        type: string
    type: object
  vo.MessageListResponse:
    properties:
      limit:
        type: integer
      messages:
        items:
          $ref: '#/definitions/vo.MessageResponse'
        type: array
      page:
        type: integer
      total:
        type: integer
    type: object
  vo.MessageResponse:
    properties:
      content:
        type: string
      created_at:
        type: string
      id:
        type: integer
      status:
        type: integer
      task_id:
        type: string
      user_id:
        type: integer
    type: object
  vo.RankingResponse:
    properties:
      created_at:
        description: CreatedAt 创建时间
        example: "2023-12-20T10:00:00Z"
        format: date-time
        type: string
      id:
        description: ID 排名ID
        example: 1
        type: integer
      rank:
        description: Rank 排名
        example: 1
        type: integer
      score:
        description: Score 分数
        example: 1000
        type: integer
      updated_at:
        description: UpdatedAt 更新时间
        example: "2023-12-20T10:00:00Z"
        format: date-time
        type: string
      username:
        description: Username 用户名
        example: player1
        type: string
    type: object
  vo.SaveGameResponse:
    properties:
      game_data:
        type: string
      saved_at:
        type: string
      slot_number:
        type: integer
      user_id:
        type: integer
    type: object
  vo.SuccessMessageResponse:
    properties:
      message:
        description: Message 消息内容
        example: success
        type: string
    type: object
  vo.UserVO:
    properties:
      id:
        description: ID 用户ID
        type: integer
      username:
        description: Username 用户名
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  description: 这是一个用户管理系统的API文档。
  termsOfService: http://swagger.io/terms/
  title: faulty_in_culture 管理系统
  version: "1.0"
paths:
  /api/chat/{session_id}:
    get:
      description: 获取指定会话的聊天历史
      parameters:
      - description: 会话ID
        in: path
        name: session_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/vo.ChatHistoryResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 获取聊天历史
      tags:
      - chat
  /api/chat/send:
    post:
      consumes:
      - application/json
      description: 向指定会话发送消息，异步调用AI并通过WebSocket返回
      parameters:
      - description: 消息内容
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/dto.ChatMessageRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 发送消息给AI
      tags:
      - chat
  /api/chat/sessions:
    get:
      description: 获取当前用户的所有聊天会话列表
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/vo.ChatSessionResponse'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 获取用户所有聊天会话
      tags:
      - chat
  /api/chat/start:
    post:
      consumes:
      - application/json
      description: 创建一个新的AI聊天会话
      parameters:
      - description: 聊天标题
        in: body
        name: data
        schema:
          $ref: '#/definitions/dto.ChatStartRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/vo.ChatSessionResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 开始新的聊天会话
      tags:
      - chat
  /api/login:
    post:
      consumes:
      - application/json
      description: 用户登录，传入用户名和密码
      parameters:
      - description: 登录信息
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/dto.UserLoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 用户登录
      tags:
      - user
  /api/messages:
    get:
      description: 获取指定用户的历史消息记录，支持分页和状态筛选
      parameters:
      - description: 用户ID
        in: query
        name: user_id
        required: true
        type: string
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: limit
        type: integer
      - description: 状态筛选
        enum:
        - pending
        - completed
        - failed
        in: query
        name: status
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/vo.MessageListResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 获取历史消息列表
      tags:
      - message
  /api/query-result:
    get:
      description: 根据任务ID查询延迟消息结果
      parameters:
      - description: 任务ID
        in: query
        name: task_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 查询消息结果
      tags:
      - message
  /api/rankings:
    get:
      description: 获取用户排行榜，按分数降序排列
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/vo.RankingResponse'
            type: array
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      summary: 获取排行榜
      tags:
      - user
  /api/register:
    post:
      consumes:
      - application/json
      description: 用户注册，传入用户名和密码
      parameters:
      - description: 注册信息
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/dto.UserRegisterRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/vo.UserVO'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 用户注册
      tags:
      - user
  /api/savegames:
    get:
      description: 获取当前用户的所有存档（最多6个）
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/vo.SaveGameResponse'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 获取用户所有存档
      tags:
      - savegame
  /api/savegames/{slot}:
    delete:
      description: 删除指定槽位的存档
      parameters:
      - description: 存档槽位(1-6)
        in: path
        name: slot
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/vo.SuccessMessageResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 删除存档
      tags:
      - savegame
    get:
      description: 获取当前用户指定槽位的存档
      parameters:
      - description: 存档槽位(1-6)
        in: path
        name: slot
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/vo.SaveGameResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 获取指定槽位的存档
      tags:
      - savegame
    put:
      consumes:
      - application/json
      description: 在指定槽位创建或更新存档
      parameters:
      - description: 存档槽位(1-6)
        in: path
        name: slot
        required: true
        type: integer
      - description: 存档数据
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/dto.SaveGameRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/vo.SaveGameResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 创建或更新存档
      tags:
      - savegame
  /api/send-message:
    post:
      consumes:
      - application/json
      description: 发送一段消息，配置时间后返回
      parameters:
      - description: 消息内容
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/dto.SendMessageRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 发送延迟消息
      tags:
      - message
  /api/user/score:
    put:
      consumes:
      - application/json
      description: 更新当前用户的分数
      parameters:
      - description: 分数信息
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateScoreRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/vo.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: 更新用户分数
      tags:
      - user
  /ws:
    get:
      description: 建立 WebSocket 连接，接收实时消息推送
      parameters:
      - description: 用户ID
        in: query
        name: user_id
        required: true
        type: string
      responses: {}
      summary: WebSocket 连接
      tags:
      - message
schemes:
- http
swagger: "2.0"
